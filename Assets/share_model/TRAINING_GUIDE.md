# YOLO æ¨¡å‹é‡æ–°è®­ç»ƒæŒ‡å—

## ä¸ºä»€ä¹ˆéœ€è¦é‡æ–°è®­ç»ƒï¼Ÿ

å½“å‰æ¨¡å‹çš„é—®é¢˜ï¼š
- âœ… æ£€æµ‹åˆ°çš„ä¿¡å¿ƒåº¦å¤ªä½ï¼ˆ19-22%ï¼‰
- âœ… å®¹æ˜“å—èƒŒæ™¯å¹²æ‰°
- âœ… åœ¨å¤æ‚ç¯å¢ƒä¸‹è¡¨ç°ä¸ä½³

æ”¹è¿›æ–¹å‘ï¼š
- ğŸ¯ ä½¿ç”¨æ›´å¤šè®­ç»ƒæ•°æ®ï¼ˆä¸åŒè§’åº¦ã€å…‰çº¿ã€èƒŒæ™¯ï¼‰
- ğŸ¯ æ•°æ®å¢å¼ºï¼ˆæ—‹è½¬ã€ç¼©æ”¾ã€äº®åº¦å˜åŒ–ï¼‰
- ğŸ¯ è°ƒæ•´è®­ç»ƒå‚æ•°ï¼ˆepochs, batch sizeï¼‰
- ğŸ¯ ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹ï¼ˆnano â†’ small â†’ mediumï¼‰

---

## æ­¥éª¤ 1ï¼šå‡†å¤‡è®­ç»ƒæ•°æ®

### 1.1 æ”¶é›†å›¾ç‰‡

**å»ºè®®æ•°é‡**ï¼š
- æ¯ä¸ªæ­¥éª¤ï¼š**è‡³å°‘ 100-200 å¼ å›¾ç‰‡**
- æ€»å…±ï¼š300-600 å¼ å›¾ç‰‡ï¼ˆ3ä¸ªæ­¥éª¤ï¼‰

**æ‹æ‘„å»ºè®®**ï¼š
- âœ… ä¸åŒè§’åº¦ï¼ˆæ­£é¢ã€ä¾§é¢ã€æ–œè§’ï¼‰
- âœ… ä¸åŒå…‰çº¿ï¼ˆè‡ªç„¶å…‰ã€å®¤å†…ç¯å…‰ï¼‰
- âœ… ä¸åŒèƒŒæ™¯ï¼ˆç™½è‰²ã€æœ¨æ¡Œã€å¤æ‚èƒŒæ™¯ï¼‰
- âœ… ä¸åŒè·ç¦»ï¼ˆè¿‘æ™¯ã€ä¸­æ™¯ï¼‰
- âœ… åŒ…å«éƒ¨åˆ†æŠ˜å çŠ¶æ€ï¼ˆè¿‡æ¸¡çŠ¶æ€ï¼‰

**å­˜å‚¨ç»“æ„**ï¼š
```
dataset/
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ shape1_001.jpg
â”‚   â”œâ”€â”€ shape1_002.jpg
â”‚   â”œâ”€â”€ shape2_001.jpg
â”‚   â””â”€â”€ ...
â””â”€â”€ labels/
    â”œâ”€â”€ shape1_001.txt
    â”œâ”€â”€ shape1_002.txt
    â””â”€â”€ ...
```

### 1.2 æ ‡æ³¨å·¥å…·æ¨è

**é€‰é¡¹ 1ï¼šLabelImg**ï¼ˆç®€å•æ˜“ç”¨ï¼‰
```bash
pip install labelImg
labelImg
```

**é€‰é¡¹ 2ï¼šRoboflow**ï¼ˆåœ¨çº¿å·¥å…·ï¼Œæ¨èï¼ï¼‰
- ç½‘å€ï¼šhttps://roboflow.com
- åŠŸèƒ½ï¼šè‡ªåŠ¨æ ‡æ³¨è¾…åŠ©ã€æ•°æ®å¢å¼ºã€æ ¼å¼è½¬æ¢
- å…è´¹ç‰ˆï¼šæœ€å¤š 10,000 å¼ å›¾ç‰‡

**é€‰é¡¹ 3ï¼šCVAT**ï¼ˆä¸“ä¸šå·¥å…·ï¼‰
- ç½‘å€ï¼šhttps://www.cvat.ai

### 1.3 æ ‡æ³¨æ ¼å¼ï¼ˆYOLOæ ¼å¼ï¼‰

æ¯å¼ å›¾ç‰‡å¯¹åº”ä¸€ä¸ª `.txt` æ–‡ä»¶ï¼Œæ ¼å¼ï¼š
```
<class_id> <x_center> <y_center> <width> <height>
```

**ç¤ºä¾‹**ï¼š`shape1_001.txt`
```
0 0.5 0.5 0.3 0.4
```
- `0`ï¼šshape_1 çš„ class_idï¼ˆshape_2=1, shape_3=2ï¼‰
- `0.5 0.5`ï¼šè¾¹ç•Œæ¡†ä¸­å¿ƒç‚¹ï¼ˆå½’ä¸€åŒ–åæ ‡ 0-1ï¼‰
- `0.3 0.4`ï¼šè¾¹ç•Œæ¡†å®½åº¦å’Œé«˜åº¦ï¼ˆå½’ä¸€åŒ–ï¼‰

### 1.4 åˆ’åˆ†æ•°æ®é›†

å»ºè®®æ¯”ä¾‹ï¼š
- **è®­ç»ƒé›†ï¼ˆtrainï¼‰**ï¼š70%ï¼ˆç”¨äºè®­ç»ƒæ¨¡å‹ï¼‰
- **éªŒè¯é›†ï¼ˆvalï¼‰**ï¼š20%ï¼ˆç”¨äºè°ƒå‚ï¼‰
- **æµ‹è¯•é›†ï¼ˆtestï¼‰**ï¼š10%ï¼ˆç”¨äºæœ€ç»ˆè¯„ä¼°ï¼‰

---

## æ­¥éª¤ 2ï¼šé…ç½®è®­ç»ƒç¯å¢ƒ

### 2.1 åˆ›å»ºæ•°æ®é›†é…ç½®æ–‡ä»¶

åˆ›å»º `dataset.yaml`ï¼š
```yaml
# æ•°æ®é›†è·¯å¾„
path: C:/Users/user/Desktop/Asynchronous Learning/Assets/share_model/dataset
train: images/train
val: images/val
test: images/test

# ç±»åˆ«
nc: 3  # ç±»åˆ«æ•°é‡
names: ['shape_1', 'shape_2', 'shape_3']
```

### 2.2 æ£€æŸ¥ Python ç¯å¢ƒ

ç¡®ä¿å·²å®‰è£…ï¼š
```bash
pip install ultralytics
pip install opencv-python
pip install matplotlib
```

---

## æ­¥éª¤ 3ï¼šå¼€å§‹è®­ç»ƒ

### 3.1 åŸºç¡€è®­ç»ƒï¼ˆæ¨èæ–°æ‰‹ï¼‰

```python
from ultralytics import YOLO

# ä½¿ç”¨ YOLOv8 nano æ¨¡å‹ï¼ˆé€Ÿåº¦å¿«ï¼‰
model = YOLO('yolov8n.pt')

# å¼€å§‹è®­ç»ƒ
results = model.train(
    data='dataset.yaml',
    epochs=100,              # è®­ç»ƒè½®æ•°
    imgsz=640,               # å›¾ç‰‡å¤§å°
    batch=16,                # æ‰¹æ¬¡å¤§å°
    name='origami_v2',       # é¡¹ç›®åç§°
    patience=20,             # æ—©åœæœºåˆ¶
)
```

### 3.2 è¿›é˜¶è®­ç»ƒï¼ˆæ›´å¥½æ•ˆæœï¼‰

```python
from ultralytics import YOLO

# ä½¿ç”¨ YOLOv8 small æ¨¡å‹ï¼ˆç²¾åº¦æ›´é«˜ï¼‰
model = YOLO('yolov8s.pt')

results = model.train(
    data='dataset.yaml',
    epochs=150,
    imgsz=640,
    batch=8,
    name='origami_v2_small',
    patience=30,
    
    # æ•°æ®å¢å¼º
    augment=True,
    hsv_h=0.015,            # è‰²è°ƒå˜åŒ–
    hsv_s=0.7,              # é¥±å’Œåº¦å˜åŒ–
    hsv_v=0.4,              # äº®åº¦å˜åŒ–
    degrees=10,             # æ—‹è½¬è§’åº¦
    translate=0.1,          # å¹³ç§»
    scale=0.5,              # ç¼©æ”¾
    flipud=0.0,             # ä¸Šä¸‹ç¿»è½¬
    fliplr=0.5,             # å·¦å³ç¿»è½¬
    mosaic=1.0,             # mosaic å¢å¼º
    
    # ä¼˜åŒ–å™¨è®¾ç½®
    optimizer='Adam',
    lr0=0.001,              # åˆå§‹å­¦ä¹ ç‡
    momentum=0.937,
    weight_decay=0.0005,
)
```

### 3.3 ä»ç°æœ‰æ¨¡å‹ç»§ç»­è®­ç»ƒï¼ˆFine-tuningï¼‰

```python
from ultralytics import YOLO

# ä»ä½ ç°æœ‰çš„æ¨¡å‹ç»§ç»­è®­ç»ƒ
model = YOLO('best.pt')

results = model.train(
    data='dataset.yaml',
    epochs=50,
    imgsz=640,
    batch=16,
    name='origami_finetune',
    resume=True,            # ç»§ç»­è®­ç»ƒ
)
```

---

## æ­¥éª¤ 4ï¼šè¯„ä¼°æ¨¡å‹

### 4.1 æŸ¥çœ‹è®­ç»ƒç»“æœ

è®­ç»ƒå®Œæˆåä¼šç”Ÿæˆï¼š
```
runs/detect/origami_v2/
â”œâ”€â”€ weights/
â”‚   â”œâ”€â”€ best.pt          # æœ€ä½³æ¨¡å‹ï¼ˆä½¿ç”¨è¿™ä¸ªï¼ï¼‰
â”‚   â””â”€â”€ last.pt          # æœ€åä¸€è½®æ¨¡å‹
â”œâ”€â”€ results.png          # è®­ç»ƒæ›²çº¿
â”œâ”€â”€ confusion_matrix.png # æ··æ·†çŸ©é˜µ
â””â”€â”€ ...
```

### 4.2 æµ‹è¯•æ¨¡å‹

```python
from ultralytics import YOLO

# åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹
model = YOLO('runs/detect/origami_v2/weights/best.pt')

# åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°
results = model.val(data='dataset.yaml')

print(f"mAP50: {results.box.map50:.3f}")      # ç²¾åº¦æŒ‡æ ‡
print(f"mAP50-95: {results.box.map:.3f}")    # æ›´ä¸¥æ ¼çš„ç²¾åº¦
```

### 4.3 å•å¼ å›¾ç‰‡æµ‹è¯•

```python
from ultralytics import YOLO

model = YOLO('runs/detect/origami_v2/weights/best.pt')

# æµ‹è¯•å•å¼ å›¾ç‰‡
results = model('test_images/test.png', conf=0.3)

# æ˜¾ç¤ºç»“æœ
results[0].show()

# æŸ¥çœ‹æ£€æµ‹è¯¦æƒ…
for box in results[0].boxes:
    print(f"Class: {results[0].names[int(box.cls)]}")
    print(f"Confidence: {box.conf[0]:.2%}")
```

---

## æ­¥éª¤ 5ï¼šæ›¿æ¢ Unity æ¨¡å‹

### 5.1 å¤åˆ¶æ–°æ¨¡å‹

```bash
# å°†è®­ç»ƒå¥½çš„æ¨¡å‹å¤åˆ¶åˆ° Unity é¡¹ç›®
copy runs/detect/origami_v2/weights/best.pt best.pt
```

### 5.2 æµ‹è¯•æ–°æ¨¡å‹

åœ¨ Unity ä¸­ï¼š
1. ç¡®ä¿ `best.pt` åœ¨ `share_model/` æ–‡ä»¶å¤¹
2. é‡æ–°å¯åŠ¨æ¸¸æˆ
3. æŒ‰ **T** é”®æµ‹è¯•æˆªå›¾
4. æ£€æŸ¥ Console çœ‹ä¿¡å¿ƒåº¦æ˜¯å¦æé«˜

### 5.3 è°ƒæ•´é˜ˆå€¼

å¦‚æœæ–°æ¨¡å‹ä¿¡å¿ƒåº¦æ›´é«˜ï¼ˆå¦‚ 60-80%ï¼‰ï¼Œå¯ä»¥æé«˜é˜ˆå€¼ï¼š
- Unity Inspector â†’ ShapeDetector â†’ confidenceThreshold = **0.5**ï¼ˆä»0.3æé«˜ï¼‰

---

## å¸¸è§é—®é¢˜

### Q1: è®­ç»ƒéœ€è¦å¤šä¹…ï¼Ÿ
- Nano æ¨¡å‹ + 100 epochsï¼š**10-30 åˆ†é’Ÿ**ï¼ˆCPUï¼‰/ **3-5 åˆ†é’Ÿ**ï¼ˆGPUï¼‰
- Small æ¨¡å‹ + 150 epochsï¼š**30-60 åˆ†é’Ÿ**ï¼ˆCPUï¼‰/ **8-15 åˆ†é’Ÿ**ï¼ˆGPUï¼‰

### Q2: æ²¡æœ‰ GPU æ€ä¹ˆåŠï¼Ÿ
- ä½¿ç”¨ **Google Colab**ï¼ˆå…è´¹ GPUï¼‰
- ä½¿ç”¨ **Kaggle Notebooks**ï¼ˆå…è´¹ GPUï¼‰
- ä½¿ç”¨ Nano æ¨¡å‹ + å‡å°‘ epochs

### Q3: è®­ç»ƒç²¾åº¦ä¸é«˜æ€ä¹ˆåŠï¼Ÿ
1. **å¢åŠ æ•°æ®é‡**ï¼ˆæœ€é‡è¦ï¼ï¼‰
2. å¢åŠ è®­ç»ƒè½®æ•°ï¼ˆepochsï¼‰
3. ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹ï¼ˆs/m/lï¼‰
4. è°ƒæ•´æ•°æ®å¢å¼ºå‚æ•°
5. æ£€æŸ¥æ ‡æ³¨æ˜¯å¦å‡†ç¡®

### Q4: å¦‚ä½•åˆ¤æ–­æ¨¡å‹æ˜¯å¦è¿‡æ‹Ÿåˆï¼Ÿ
æŸ¥çœ‹ `results.png`ï¼š
- **è®­ç»ƒæŸå¤±æŒç»­ä¸‹é™ï¼ŒéªŒè¯æŸå¤±ä¸Šå‡** â†’ è¿‡æ‹Ÿåˆ
- **è§£å†³æ–¹æ¡ˆ**ï¼šå‡å°‘ epochsã€å¢åŠ æ•°æ®ã€å¢å¼ºæ­£åˆ™åŒ–

---

## æ¨èè®­ç»ƒæµç¨‹

### ğŸ¯ æœ€ä½³å®è·µ

1. **å¿«é€ŸéªŒè¯**ï¼ˆç¡®è®¤æµç¨‹å¯è¡Œï¼‰
   - ä½¿ç”¨ 30 å¼ å›¾ç‰‡
   - YOLOv8n + 50 epochs
   - ç¡®è®¤èƒ½è·‘é€š

2. **ä¸­ç­‰è§„æ¨¡è®­ç»ƒ**ï¼ˆåˆæ­¥æ”¹è¿›ï¼‰
   - ä½¿ç”¨ 100-200 å¼ å›¾ç‰‡
   - YOLOv8n + 100 epochs
   - æµ‹è¯•æ•ˆæœ

3. **å®Œæ•´è®­ç»ƒ**ï¼ˆè¿½æ±‚æœ€ä½³æ•ˆæœï¼‰
   - ä½¿ç”¨ 300-600 å¼ å›¾ç‰‡
   - YOLOv8s + 150-200 epochs
   - æ•°æ®å¢å¼º
   - Fine-tuning

---

## ä¸‹ä¸€æ­¥

æˆ‘å·²ç»ä¸ºä½ åˆ›å»ºäº†ï¼š
1. âœ… `train_model.py` - è®­ç»ƒè„šæœ¬
2. âœ… `dataset_template.yaml` - æ•°æ®é›†é…ç½®æ¨¡æ¿
3. âœ… `prepare_dataset.py` - æ•°æ®é›†å‡†å¤‡å·¥å…·
4. âœ… `evaluate_model.py` - æ¨¡å‹è¯„ä¼°è„šæœ¬

ç›´æ¥è¿è¡Œ `python train_model.py` å³å¯å¼€å§‹è®­ç»ƒï¼
